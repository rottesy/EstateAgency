Приложение для управления агентством недвижимости обеспечивает ведение каталога объектов недвижимости, управление клиентской базой, контроль сделок купли-продажи, организацию аукционных торгов, а также отображение статистики. Основные функции системы направлены на автоматизацию процессов управления объектами различных типов, ведение базы клиентов, отслеживание сделок на всех этапах их жизненного цикла и эффективное использование механизмов продажи недвижимости. Программа реализует следующие ключевые возможности:

– создание, редактирование и удаление объектов недвижимости различных типов (квартиры, дома, коммерческая недвижимость) с отслеживанием их статуса доступности, цены, площади и специфических характеристик для каждого типа;

– управление клиентской базой с возможностью добавления, изменения и удаления информации о клиентах, валидацией контактных данных и отслеживанием даты добавления;

– создание сделок между клиентами и объектами недвижимости с указанием финальной цены, статуса сделки и даты совершения для структурирования процесса продажи;

– управление статусами сделок (в ожидании, завершена, отменена) с автоматическим обновлением статуса доступности объектов недвижимости при изменении состояния сделок;

– контроль доступности объектов недвижимости с проверкой отсутствия активных сделок для объекта, предотвращением создания конфликтующих сделок и автоматическим обновлением статуса при изменении состояния сделок;

– организация аукционных торгов с созданием аукционов для объектов недвижимости, управлением ставками участников, отслеживанием текущей максимальной ставки, автоматическим завершением при достижении цены выкупа и автоматическим созданием сделки при завершении аукциона;

– ведение истории всех операций с объектами недвижимости, клиентами, сделками и аукционами для обеспечения полноты информации;

– автоматическое сохранение данных в текстовом формате при закрытии приложения и загрузка данных при запуске для обеспечения сохранности информации;

– отображение статистики по агентству, включающей общее количество объектов недвижимости, клиентов, сделок, аукционов и количество доступных объектов;

– поиск объектов недвижимости по идентификатору и адресу, клиентов по идентификатору и имени, сделок и аукционов по идентификатору для быстрого доступа к информации;

– использование пользовательских исключений для обработки ошибок, связанных с операциями над объектами недвижимости, клиентами, сделками и аукционами, что обеспечивает надежность работы системы.

Для более детального понимания архитектуры проекта используется диаграмма классов (Приложение А), которая визуализирует структуру системы и взаимосвязи между основными компонентами.

2.1 Описание функции управления объектами недвижимости

Функция обеспечивает управление каталогом объектов недвижимости агентства. Реализованы операции добавления, редактирования, удаления и поиска объектов. Система поддерживает три типа объектов недвижимости (Apartment, House, CommercialProperty), каждый со специфическими характеристиками. Для квартир отслеживается количество комнат, этаж, наличие балкона и лифта. Для домов учитывается количество этажей, количество комнат, площадь участка, наличие гаража и сада. Для коммерческой недвижимости фиксируется тип коммерческого использования, наличие парковки, количество парковочных мест и видимость с улицы. Для каждого объекта отслеживается статус доступности, цена, площадь, адрес (город, улица, дом) и описание. При добавлении проверяется уникальность идентификатора объекта и валидность всех параметров (цена должна быть от 10000 до 1000000000 рублей, площадь должна быть положительным числом, адрес не должен быть пустым). Реализован поиск по идентификатору (точное совпадение, если введены только цифры длиной от 6 до 8 символов) и по адресу (частичное совпадение по городу, улице или дому). При выборе объекта в таблице отображается детальная информация об объекте, включая все характеристики в зависимости от типа, а также список всех связанных сделок с указанием клиента, цены и статуса. Система автоматически обновляет статус доступности объектов при завершении или отмене сделок, обеспечивая актуальность информации о доступных объектах.

2.2 Описание функции управления клиентской базой

Функция обеспечивает управление клиентской базой агентства. Реализованы операции добавления, редактирования, удаления и поиска клиентов. Каждый клиент содержит информацию об идентификаторе, имени, телефоне, email и дате добавления в систему. Система автоматически устанавливает дату добавления клиента при создании записи в формате ISO 8601. Система выполняет валидацию контактных данных: проверку формата телефона (поддержка форматов +7XXXXXXXXXX и 8XXXXXXXXXX) и проверку формата email с использованием регулярных выражений. При добавлении проверяется уникальность идентификатора клиента и корректность всех полей. Реализован поиск клиентов по идентификатору (точное совпадение, если введены только цифры длиной от 6 до 8 символов) и по имени (частичное совпадение, поиск по подстроке). При выборе клиента в таблице отображается детальная информация о клиенте, включая все контактные данные и дату добавления, а также список всех связанных сделок с указанием объекта недвижимости, цены и статуса. Система автоматически связывает клиентов со сделками и ставками в аукционах, что позволяет анализировать активность клиентов и историю их взаимодействия с агентством.

2.3 Описание функции управления сделками

Функция обеспечивает управление сделками купли-продажи недвижимости. Реализованы операции создания, редактирования, удаления и поиска сделок. При создании сделки система требует выбора объекта недвижимости из списка доступных объектов и клиента из списка зарегистрированных клиентов. Система автоматически устанавливает дату создания сделки в формате ISO 8601 и связывает сделку с объектом недвижимости и клиентом. Каждая сделка имеет уникальный идентификатор (от 6 до 8 цифр). Система поддерживает три статуса сделок: "pending" (в ожидании), "completed" (завершена) и "cancelled" (отменена). При создании или редактировании сделки выполняется валидация: проверка существования объекта недвижимости и клиента, проверка доступности объекта недвижимости для сделок со статусом "pending" или "completed" (объект не должен участвовать в других активных сделках), проверка финальной цены (должна быть от 10000 до 1000000000 рублей). При завершении сделки со статусом "completed" система автоматически обновляет статус доступности объекта недвижимости на "недоступен". При отмене сделки со статусом "cancelled" система возвращает объект в статус "доступен", если объект не участвует в других активных сделках. При удалении сделки система проверяет наличие других активных сделок для объекта и при необходимости обновляет его статус доступности. Реализован поиск сделок по идентификатору (точное совпадение, если введены только цифры длиной от 6 до 8 символов). При выборе сделки в таблице отображается детальная информация о сделке, включая данные об объекте недвижимости и клиенте. Система отслеживает финальную цену сделки, которая может отличаться от цены объекта, и позволяет добавлять примечания к сделкам.

2.4 Описание функции управления аукционными торгами

Функция обеспечивает организацию и управление аукционными торгами для объектов недвижимости. Реализованы операции создания, просмотра, удаления и поиска аукционов. При создании аукциона система требует выбора объекта недвижимости из списка доступных объектов (объекты, не участвующие в активных сделках или активных аукционах). Система автоматически устанавливает дату создания аукциона в формате ISO 8601 и начальный статус "active". Цена выкупа (buyout) автоматически рассчитывается как начальная цена, умноженная на 1.7 (на 70% больше начальной цены). Для каждого аукциона система управляет ставками участников: клиенты могут делать ставки через диалоговое окно просмотра аукциона. При добавлении ставки выполняется проверка, что ставка превышает текущую максимальную ставку (минимум на 0.01 рубля) или равна начальной цене, если ставок еще нет. Если ставка достигает или превышает цену выкупа, аукцион автоматически завершается и создается сделка со статусом "completed" для клиента, сделавшего ставку. Система отслеживает историю всех ставок с указанием клиента, суммы ставки и времени размещения. При просмотре аукциона отображается текущая максимальная ставка, информация о победителе (если есть), список всех ставок, отсортированный по убыванию суммы, и информация об объекте недвижимости. Аукционы могут быть завершены вручную через кнопку "Завершить аукцион" в диалоговом окне. При ручном завершении аукциона создается сделка для клиента с максимальной ставкой. Если на аукционе нет ставок, аукцион может быть отменен. При завершении или отмене аукциона система обновляет статус аукциона на "completed" или "cancelled" соответственно и устанавливает дату завершения. Система отслеживает статусы аукционов (active, completed, cancelled) и обеспечивает связь между аукционами и объектами недвижимости. При создании сделки из аукциона система автоматически генерирует уникальный идентификатор сделки и устанавливает статус доступности объекта недвижимости на "недоступен". Реализован поиск аукционов по идентификатору (точное совпадение, если введены только цифры длиной от 6 до 8 символов).

2.5 Описание функции поиска данных

Функция обеспечивает быстрый поиск данных во всех разделах системы. Для объектов недвижимости реализован поиск по идентификатору (точное совпадение, если поисковый запрос содержит только цифры длиной от 6 до 8 символов) и по адресу (частичное совпадение, если поисковый запрос содержит не только цифры). Поиск по адресу выполняется по городу, улице или дому с использованием частичного совпадения (без учета регистра), что позволяет находить объекты даже при неполном указании адреса. Для клиентов реализован поиск по идентификатору (точное совпадение, если поисковый запрос содержит только цифры длиной от 6 до 8 символов) и по имени (частичное совпадение, если поисковый запрос содержит не только цифры). Поиск по имени выполняется с использованием частичного совпадения, что позволяет находить клиентов по части имени. Для сделок реализован поиск по идентификатору (точное совпадение, если поисковый запрос содержит только цифры длиной от 6 до 8 символов). Для аукционов реализован поиск по идентификатору (точное совпадение, если поисковый запрос содержит только цифры длиной от 6 до 8 символов). Все результаты поиска отображаются в таблицах с возможностью просмотра детальной информации при выборе записи. Система обеспечивает обновление результатов поиска при нажатии кнопки "Найти" или при очистке поля поиска (отображаются все записи).

2.6 Описание функции контроля доступности объектов

Функция обеспечивает контроль доступности объектов недвижимости при создании сделок и аукционов. При создании сделки со статусом "pending" или "completed" система проверяет, что объект недвижимости не участвует в других активных сделках со статусом "pending" или "completed", что предотвращает создание конфликтующих сделок. При создании аукциона система проверяет, что объект недвижимости не участвует в активных сделках и не участвует в других активных аукционах, что гарантирует корректность организации торгов. При завершении сделки со статусом "completed" система автоматически обновляет статус доступности объекта на "недоступен", что предотвращает создание новых сделок для уже проданного объекта. При отмене сделки со статусом "cancelled" система автоматически возвращает объект в статус "доступен", если объект не участвует в других активных сделках или аукционах. При удалении сделки система проверяет наличие других активных сделок для объекта и при отсутствии таковых возвращает объект в статус "доступен". При завершении аукциона система также обновляет статус доступности объекта на "недоступен" через создание сделки. Система отслеживает текущий статус каждого объекта и обеспечивает автоматическую синхронизацию статусов при изменении состояния связанных сделок и аукционов, что гарантирует актуальность информации о доступных объектах.

2.7 Описание функции валидации данных

Функция обеспечивает проверку корректности вводимых данных на всех уровнях системы. Для объектов недвижимости выполняется валидация идентификатора (должен содержать только цифры, длина от 6 до 8 символов), цены (должна быть в диапазоне от 10000 до 1000000000 рублей), площади (должна быть положительным числом) и адреса (город, улица и дом не должны быть пустыми). Для клиентов выполняется валидация идентификатора (должен содержать только цифры, длина от 6 до 8 символов), телефона (формат +7XXXXXXXXXX или 8XXXXXXXXXX) и email (проверка формата с использованием регулярных выражений). Для сделок выполняется валидация идентификатора (должен содержать только цифры, длина от 6 до 8 символов), финальной цены (должна быть в диапазоне от 10000 до 1000000000 рублей), статуса (должен быть одним из допустимых значений: "pending", "completed", "cancelled") и доступности объекта недвижимости. Для аукционов выполняется валидация идентификатора (должен содержать только цифры, длина от 6 до 8 символов) и стартовой цены (должна быть положительным числом). При добавлении ставок в аукцион выполняется проверка, что ставка превышает текущую максимальную ставку минимум на 0.01 рубля или равна начальной цене, если ставок еще нет. Система предоставляет информативные сообщения об ошибках валидации через диалоговые окна и предотвращает создание некорректных записей, что обеспечивает целостность данных в системе.

2.8 Описание функции отображения детальной информации

Функция обеспечивает отображение детальной информации о записях в диалоговых окнах редактирования, которые открываются при нажатии кнопки "Редактировать" в таблице соответствующего раздела.

Для объектов недвижимости диалог редактирования отображает поля для редактирования общей информации (тип, идентификатор, адрес, цена, площадь, описание, доступность) и динамически показывает специфические поля в зависимости от типа: для квартир - количество комнат, этаж, наличие балкона и лифта; для домов - количество этажей, комнат, площадь участка, наличие гаража и сада; для коммерческой недвижимости - тип бизнеса, наличие парковки, количество парковочных мест, видимость с улицы. При редактировании существующего объекта все поля автоматически заполняются данными через метод loadPropertyData.

Для клиентов диалог редактирования отображает поля для редактирования идентификатора, имени, телефона и email. При редактировании существующего клиента все поля автоматически заполняются данными.

Для сделок диалог редактирования отображает поля для редактирования идентификатора, выбора объекта недвижимости и клиента из выпадающих списков, финальной цены, статуса и примечаний. При выборе объекта недвижимости автоматически отображается цена объекта и подставляется в поле цены сделки. Отображается разница между ценой сделки и ценой недвижимости.

Для аукционов диалог редактирования работает в двух режимах. В режиме создания отображаются поля для ввода идентификатора, выбора объекта недвижимости и начальной цены. При выборе объекта автоматически рассчитывается цена выкупа (начальная цена × 1.7). В режиме просмотра (при открытии существующего аукциона) все поля основной информации доступны только для чтения, и дополнительно отображается таблица всех ставок с возможностью добавления новых ставок и ручного завершения аукциона. Отображается текущая максимальная ставка с указанием клиента-лидера.

Все диалоги используют единый стиль оформления и обеспечивают валидацию вводимых данных перед принятием изменений.

2.9 Описание функции сохранения и загрузки данных

Функция обеспечивает сохранение и загрузку данных агентства в текстовом формате с разделителями. При сохранении данные записываются в отдельные файлы для объектов недвижимости (properties.txt), клиентов (clients.txt), сделок (transactions.txt) и аукционов (auctions.txt) с использованием разделителя полей '|'. Маркеры типов недвижимости записываются как APARTMENT, HOUSE, COMMERCIAL. Каждое поле данных записывается в формате с разделителем, где поля отделены символом '|'. Для объектов недвижимости сохраняется информация о типе, идентификаторе, адресе (город, улица, дом), цене, площади, описании, статусе доступности (1 для доступных, 0 для недоступных) и специфических полях для каждого типа (для квартир: количество комнат, этаж, наличие балкона и лифта; для домов: количество этажей, количество комнат, площадь участка, наличие гаража и сада; для коммерческой недвижимости: тип бизнеса, наличие парковки, количество парковочных мест, видимость с улицы). Для клиентов сохраняется идентификатор, имя, телефон, email и дата добавления. Для сделок сохраняется идентификатор, идентификатор объекта недвижимости, идентификатор клиента, дата, финальная цена, статус и примечания. Для аукционов сохраняется идентификатор, идентификатор объекта недвижимости, адрес объекта, стартовая цена, цена выкупа, статус, даты создания и завершения, а также все ставки в формате BID:clientId|clientName|amount|timestamp, где каждая ставка записывается на отдельной строке с префиксом BID:. При загрузке система последовательно читает данные из файлов, парсит разделители и восстанавливает структуру данных. Реализована обработка ошибок при чтении файлов: если файл не существует, система продолжает работу с пустыми данными. Система автоматически сохраняет данные при закрытии приложения через метод destroyInstance класса EstateAgency и загружает их при запуске через метод loadAllData, обеспечивая сохранность информации.

2.10 Описание функции отображения статистики

Функция обеспечивает отображение статистической информации об агентстве недвижимости на дашборде. Система рассчитывает и отображает общее количество объектов недвижимости, общее количество клиентов, общее количество сделок, общее количество аукционов и количество доступных объектов недвижимости. Статистика отображается на дашборде в виде карточек с крупными цифрами и цветовой индикацией (разные цвета для разных метрик). Дашборд также содержит кнопки для сохранения данных, загрузки данных и обновления всех виджетов. Система обеспечивает обновление статистики в реальном времени при изменении данных через метод updateStats виджета DashboardWidget, что позволяет отслеживать актуальное состояние агентства. Статистика обновляется автоматически при переключении на вкладку дашборда и при выполнении операций с данными через сигналы dataChanged от виджетов.

2.11 Описание функции обработки ошибок и исключений

Функция обеспечивает надежную обработку ошибок и исключительных ситуаций на всех уровнях системы. Система использует специализированные классы исключений для различных компонентов: PropertyManagerException для ошибок управления недвижимостью, ClientManagerException для ошибок управления клиентами, TransactionManagerException для ошибок управления сделками, AuctionManagerException для ошибок управления аукционами и FileManagerException для ошибок работы с файлами. При возникновении ошибок система предоставляет информативные сообщения пользователю через диалоговые окна QMessageBox с указанием типа ошибки и деталей проблемы. Система обрабатывает стандартные исключения C++ (std::invalid_argument, std::bad_alloc, std::filesystem_error и другие) и преобразует их в понятные сообщения для пользователя. При ошибках валидации данных система предотвращает создание некорректных записей и информирует пользователя о причинах ошибки через предупреждающие диалоги. При ошибках работы с файлами система обеспечивает корректную обработку ситуаций отсутствия файлов или ошибок чтения, позволяя приложению продолжать работу с пустыми данными. При инициализации приложения все исключения обрабатываются с отображением критических сообщений об ошибках. Это обеспечивает надежность работы системы и предотвращает потерю данных при возникновении исключительных ситуаций.

2.12 Описание функции автоматического обновления статусов

Функция обеспечивает автоматическое обновление статусов объектов недвижимости при изменении состояния связанных сделок и аукционов. При завершении сделки со статусом "completed" система автоматически обновляет статус доступности объекта недвижимости на "недоступен" через метод setAvailable(false), что предотвращает создание новых сделок для уже проданного объекта. При отмене сделки со статусом "cancelled" система автоматически возвращает объект в статус "доступен" через метод setAvailable(true), если объект не участвует в других активных сделках или аукционах (проверка выполняется через метод hasActiveTransactions). При удалении сделки система проверяет наличие других активных сделок для объекта и при отсутствии таковых обновляет статус объекта на "доступен". При завершении аукциона (автоматически при достижении цены выкупа или вручную) система создает сделку со статусом "completed", что автоматически обновляет статус доступности объекта на "недоступен". Система проверяет состояние всех связанных сделок и аукционов перед изменением статуса объекта, что гарантирует корректность обновления. При создании новой сделки со статусом "pending" или "completed" система также обновляет статус объекта на "недоступен". Это обеспечивает консистентность данных в системе и автоматически поддерживает актуальность информации о доступных объектах.
